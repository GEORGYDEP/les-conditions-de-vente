
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comptabilit√© 4e - Conditions de Vente</title>
    
    <!-- Import Map pour la r√©solution des modules ES par le navigateur -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client"
        }
    }
    </script>

    <!-- Babel Standalone pour la transpilation JSX au runtime -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Framework CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        input:focus, textarea:focus { outline: none; border-color: #6366f1; ring: 2px; ring-color: #e0e7ff; }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Script avec type text/babel et data-type module pour combiner JSX et Imports ESM -->
    <script type="text/babel" data-type="module">
        import React, { useState, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';

        // --- DONN√âES DES EXERCICES ---
        const analysisExercises = [
            {
                id: 1,
                title: "Analyse 1 : OfficePro.be",
                conditions: {
                    name: "OfficePro.be",
                    prix: "Tous nos prix s'entendent HTVA (TVA 21% non incluse).",
                    livraison: "Franco domicile d√®s 75 ‚Ç¨ d'achat. Frais de port forfaitaires de 6,50 ‚Ç¨ pour toute commande inf√©rieure.",
                    delai: "Livraison sous 24h √† 48h ouvrables.",
                    paiement: "Bancontact, Carte de Cr√©dit, PayPal. Facturation √† 30 jours pour les administrations publiques.",
                    reductions: "Remise de 15% pour toute commande de plus de 500 unit√©s. Escompte de 3% pour paiement au grand comptant (√† la r√©ception).",
                    reclamations: "Toute r√©clamation doit √™tre introduite par √©crit dans les 5 jours suivant la livraison."
                },
                questions: [
                    { id: 1, text: "Quelles sont les conditions de livraison ? Explique.", correctAnswer: "Franco (gratuit) si la commande est ‚â• 75 ‚Ç¨. Sinon, 6,50 ‚Ç¨ de frais de port. D√©lai : 24-48h." },
                    { id: 2, text: "Une √©cole commande pour 60 ‚Ç¨ de mat√©riel. Quel sera le montant des frais de livraison ?", correctAnswer: "6,50 ‚Ç¨ car le montant est inf√©rieur au seuil de 75 ‚Ç¨." },
                    { id: 3, text: "Un client paie sa facture d√®s r√©ception. De quelle r√©duction peut-il b√©n√©ficier ?", correctAnswer: "Un escompte de 3% (paiement au grand comptant)." }
                ]
            },
            {
                id: 2,
                title: "Analyse 2 : ElectroTech Express",
                conditions: {
                    name: "ElectroTech Express",
                    prix: "Prix nets TVAC affich√©s.",
                    livraison: "Livraison standard 4,90 ‚Ç¨. Franco de port √† partir de 150 ‚Ç¨ d'achat.",
                    delai: "Exp√©dition le jour m√™me pour toute commande pass√©e avant 12h.",
                    paiement: "Virement bancaire ou esp√®ces en magasin. Professionnels : paiement √† 30 jours date de facture.",
                    reductions: "Remise fid√©lit√© de 5% d√®s le 3√®me achat annuel. Escompte de 1% pour paiement sous 10 jours.",
                    reclamations: "Signalement des avaries de transport end√©ans les 48 heures."
                },
                questions: [
                    { id: 1, text: "√Ä partir de quel montant la livraison devient-elle gratuite ?", correctAnswer: "√Ä partir de 150 ‚Ç¨ d'achat." },
                    { id: 2, text: "Quelle est l'√©ch√©ance de paiement pour un client professionnel ?", correctAnswer: "30 jours apr√®s la date de la facture." },
                    { id: 3, text: "Un client paie le 5√®me jour. Quel avantage financier obtient-il ?", correctAnswer: "Un escompte de 1% (car paiement effectu√© sous 10 jours)." }
                ]
            }
        ];

        const calculationExercises = [
            {
                id: 1,
                title: "Calcul 1 : Librairie du Centre",
                companyName: "Librairie du Centre (SRL)",
                supplierName: "Papeterie Gros",
                items: [{ label: "Ramettes de papier A4", quantity: 80, unitPrice: 4.50 }],
                remiseRate: 10,
                remiseThreshold: 300,
                escompteRate: 2,
                escompteDays: 8
            },
            {
                id: 2,
                title: "Calcul 2 : Garage du Midi",
                companyName: "Garage du Midi",
                supplierName: "Pneus-Direct",
                items: [{ label: "Pneus √©t√© 205/55 R16", quantity: 12, unitPrice: 95.00 }],
                remiseRate: 5,
                remiseThreshold: 1000,
                escompteRate: 3,
                escompteDays: 5
            }
        ];

        // --- COMPOSANTS ---

        const AnalysisExercise = ({ data }) => {
            const [userAnswers, setUserAnswers] = useState({});
            const [submitted, setSubmitted] = useState({});

            const toggleSubmit = (id) => setSubmitted(p => ({ ...p, [id]: !p[id] }));

            return (
                <div className="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden mb-12 animate-fadeIn">
                    <div className="bg-amber-600 px-6 py-4 text-white flex items-center gap-2">
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                        <h2 className="text-xl font-bold">{data.title}</h2>
                    </div>
                    <div className="p-6">
                        <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-6 mb-8">
                            <h3 className="text-center font-bold text-lg mb-4 underline uppercase text-amber-900">{data.conditions.name}</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm leading-relaxed text-slate-800">
                                <p><strong>üí∞ Prix :</strong> {data.conditions.prix}</p>
                                <p><strong>üöö Livraison :</strong> {data.conditions.livraison}</p>
                                <p><strong>‚è±Ô∏è D√©lai :</strong> {data.conditions.delai}</p>
                                <p><strong>üí≥ Paiement :</strong> {data.conditions.paiement}</p>
                                <p><strong>üìâ R√©ductions :</strong> {data.conditions.reductions}</p>
                                <p><strong>üìù R√©clamations :</strong> {data.conditions.reclamations}</p>
                            </div>
                        </div>
                        <div className="space-y-6">
                            {data.questions.map((q, idx) => (
                                <div key={q.id} className="bg-slate-50 p-5 rounded-xl border border-slate-100">
                                    <p className="font-bold text-slate-800 mb-3">{idx + 1}. {q.text}</p>
                                    <textarea
                                        disabled={submitted[q.id]}
                                        className="w-full p-4 border-2 border-slate-200 rounded-lg focus:border-amber-500 outline-none text-sm transition-all bg-white"
                                        rows="3"
                                        value={userAnswers[q.id] || ''}
                                        onChange={(e) => setUserAnswers({...userAnswers, [q.id]: e.target.value})}
                                    />
                                    <button
                                        onClick={() => toggleSubmit(q.id)}
                                        className={`mt-3 px-6 py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all ${
                                            submitted[q.id] ? 'bg-slate-500 text-white' : 'bg-amber-600 text-white hover:bg-amber-700 shadow-md'
                                        }`}
                                    >
                                        {submitted[q.id] ? "Modifier ma r√©ponse" : "Valider et voir la solution"}
                                    </button>
                                    {submitted[q.id] && (
                                        <div className="mt-4 p-4 bg-green-50 border-l-4 border-green-500 text-green-900 text-sm italic animate-fadeIn">
                                            <strong>Corrig√© type :</strong> {q.correctAnswer}
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const CalculationExercise = ({ data }) => {
            const [inputs, setInputs] = useState({ gross: '', remise: '', netCom: '', escompte: '', final: '' });
            const [validated, setValidated] = useState(false);

            const calcs = useMemo(() => {
                const gross = data.items.reduce((acc, i) => acc + (i.quantity * i.unitPrice), 0);
                const remise = gross > data.remiseThreshold ? (gross * data.remiseRate / 100) : 0;
                const netCom = gross - remise;
                const escompte = (netCom * data.escompteRate / 100);
                const final = netCom - escompte;
                return { gross, remise, netCom, escompte, final };
            }, [data]);

            const checkStyle = (field) => {
                if (!validated) return "border-slate-200 focus:border-indigo-500";
                const userVal = parseFloat(inputs[field].replace(',', '.'));
                return Math.abs(userVal - calcs[field]) < 0.05 
                    ? "border-green-500 bg-green-50 text-green-700 font-bold" 
                    : "border-red-500 bg-red-50 text-red-700 font-bold";
            };

            const format = (v) => new Intl.NumberFormat('fr-BE', { style: 'currency', currency: 'EUR' }).format(v);

            return (
                <div className="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden mb-12 animate-fadeIn">
                    <div className="bg-indigo-700 px-6 py-4 text-white flex items-center gap-2">
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>
                        <h2 className="text-xl font-bold">{data.title}</h2>
                    </div>
                    <div className="p-6">
                        <div className="bg-slate-800 text-white p-6 rounded-xl mb-8 shadow-inner">
                            <p className="text-indigo-300 font-bold uppercase text-xs mb-2">√ânonc√© de l'exercice</p>
                            <p className="text-lg mb-4"><strong>{data.companyName}</strong> ach√®te chez <strong>{data.supplierName}</strong> :</p>
                            <div className="bg-slate-700/50 p-4 rounded-lg border border-slate-600 mb-4">
                                <p className="font-semibold text-slate-100">{data.items[0].quantity} x {data.items[0].label} √† {format(data.items[0].unitPrice)}</p>
                            </div>
                            <div className="grid grid-cols-2 gap-4 text-sm text-slate-400 italic">
                                <p>‚Ä¢ Remise : {data.remiseRate}% (si > {format(data.remiseThreshold)})</p>
                                <p>‚Ä¢ Escompte : {data.escompteRate}% (paiement comptant)</p>
                            </div>
                        </div>
                        <div className="overflow-x-auto rounded-xl border border-slate-200 mb-6">
                            <table className="w-full text-left">
                                <thead className="bg-slate-50 text-xs font-bold text-slate-500 uppercase tracking-widest border-b border-slate-200">
                                    <tr>
                                        <th className="p-4">√âtape de calcul</th>
                                        <th className="p-4 text-right">Votre r√©sultat (‚Ç¨)</th>
                                        {validated && <th className="p-4 text-right bg-indigo-50 text-indigo-700">Solution</th>}
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-100">
                                    {[
                                        {key: 'gross', label: 'Prix Brut'},
                                        {key: 'remise', label: `Remise (${data.remiseRate}%)`},
                                        {key: 'netCom', label: 'Net Commercial'},
                                        {key: 'escompte', label: `Escompte (${data.escompteRate}%)`},
                                        {key: 'final', label: 'NET √Ä PAYER'}
                                    ].map((row) => (
                                        <tr key={row.key} className={row.key === 'final' ? 'bg-indigo-50/50 font-black' : ''}>
                                            <td className="p-4 text-sm text-slate-700">{row.label}</td>
                                            <td className="p-4 text-right">
                                                <input
                                                    type="text"
                                                    className={`w-32 p-2 text-right border-2 rounded-lg outline-none transition-all ${checkStyle(row.key)}`}
                                                    value={inputs[row.key]}
                                                    placeholder="0,00"
                                                    onChange={e => setInputs({...inputs, [row.key]: e.target.value})}
                                                    disabled={validated}
                                                />
                                            </td>
                                            {validated && <td className="p-4 text-right text-sm font-bold text-indigo-900 bg-indigo-50">{format(calcs[row.key])}</td>}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        <div className="flex flex-col items-center gap-4">
                            <button
                                onClick={() => setValidated(!validated)}
                                className={`px-10 py-4 rounded-full font-black text-sm uppercase tracking-widest shadow-xl transition-all active:scale-95 ${
                                    validated ? 'bg-slate-200 text-slate-700' : 'bg-indigo-700 text-white hover:bg-indigo-800 ring-4 ring-indigo-100'
                                }`}
                            >
                                {validated ? "Recommencer l'exercice" : "Valider mes r√©sultats"}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('analysis');

            return (
                <div className="min-h-screen pb-12">
                    <header className="bg-slate-800 text-white shadow-lg p-10 mb-8">
                        <div className="max-w-5xl mx-auto text-center">
                            <h1 className="text-4xl font-extrabold mb-2 uppercase tracking-tight">Comptabilit√© 4e : Fiche 5</h1>
                            <p className="text-indigo-300 italic text-xl">Analyse des conditions de vente et calculs de prix net</p>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-4">
                        <div className="flex justify-center gap-4 mb-10">
                            <button
                                onClick={() => setActiveTab('analysis')}
                                className={`px-10 py-4 rounded-full font-bold shadow-lg transition-all ${
                                    activeTab === 'analysis' ? 'bg-amber-600 text-white scale-105' : 'bg-white text-slate-600 hover:bg-slate-50'
                                }`}
                            >
                                üîç Analyse des CGV
                            </button>
                            <button
                                onClick={() => setActiveTab('calculation')}
                                className={`px-10 py-4 rounded-full font-bold shadow-lg transition-all ${
                                    activeTab === 'calculation' ? 'bg-indigo-700 text-white scale-105' : 'bg-white text-slate-600 hover:bg-slate-50'
                                }`}
                            >
                                üßÆ Exercices de calcul
                            </button>
                        </div>

                        <div className="animate-fadeIn">
                            {activeTab === 'analysis' ? (
                                <div className="space-y-6">
                                    {analysisExercises.map(ex => <AnalysisExercise key={ex.id} data={ex} />)}
                                </div>
                            ) : (
                                <div className="space-y-6">
                                    {calculationExercises.map(ex => <CalculationExercise key={ex.id} data={ex} />)}
                                </div>
                            )}
                        </div>
                    </main>

                    <footer className="mt-20 text-center text-slate-400 text-sm border-t border-slate-200 pt-8 pb-4">
                        <p>¬© Institut Saint-Luc - Cours de Comptabilit√© 4e Technique</p>
                        <p className="mt-2 text-xs">Propuls√© par React 18 & Babel Standalone (No-Build Architecture)</p>
                    </footer>
                </div>
            );
        };

        // Montage de l'application
        const container = document.getElementById('root');
        if (container) {
            const root = createRoot(container);
            root.render(<App />);
        }
    </script>
</body>
</html>
